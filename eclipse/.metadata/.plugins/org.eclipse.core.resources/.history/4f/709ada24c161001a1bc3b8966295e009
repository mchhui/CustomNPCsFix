package mchhui.customnpcsfix.command;

import java.io.File;
import java.io.IOException;

import net.minecraft.command.CommandBase;
import net.minecraft.command.ICommandSender;
import net.minecraft.util.ChatComponentText;
import noppes.npcs.controllers.PlayerDataController;
import noppes.npcs.util.JsonException;
import noppes.npcs.util.NBTJsonUtil;

public class CommandHueihuea extends CommandBase {

    @Override
    public String getCommandName() {
        return "hueihuea";
    }

    @Override
    public String getCommandUsage(ICommandSender p_71518_1_) {
        // TODO 自动生成的方法存根
        return "/hueihuea help";
    }

    @Override
    public void processCommand(ICommandSender sender, String[] args) {
        if (args.length == 0) {
            args = new String[] { "help" };
        }
        if (args.length == 1) {
            if (args[0].equals("help")) {
                sender.addChatMessage(new ChatComponentText("/hueihuea gson playerdata 把所有playerdata转为gson序列储存"));
                return;
            }
        }
        if (args.length == 2) {
            if (args[0].equals("reserialize") && args[1].equals("playerdata")) {
                File[] files = PlayerDataController.instance.getSaveDir().listFiles();
                for (File file : files) {
                    if (!file.isDirectory() && file.getName().endsWith(".json")) {
                        try {
                            NBTJsonUtil.SaveFile(file, NBTJsonUtil.LoadFile(file));
                        } catch (IOException | JsonException e) {
                            // TODO 自动生成的 catch 块
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
    }

}
